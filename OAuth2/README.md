# FastAPI_OAuth2
OAuth2 project in FastAPI

Команда создания первой ревизии базы данных:

``` lembic revision --autogenerate -m "Added accounts tables" ```

После этого надо внести изменения в сформированный файл ревизии в каталоге
*version*, а именно добавить импорт 
```
from Auth.db.db_connection import db_session
from Auth.utils import init_users
from Auth.db.db_types import MyDateTime
```
и в конце функции *upgrade*, после добавления колонок, вызвать инициализацию базы данных 
начальными пользователями

``` init_users(db_session) ```

Для инициализации базы данных надо запустить команду alembic из директории OAuth2

``` alembic upgrade head ```

Так как при тестировании инициализируется тестовая база данных через alembic, то для
тестирования используется конфигурационный файл alembic.ini. По этой причине 
тесты следует запускать не из директории *tests*, а из директории *OAuth2*, в которой
и находиться конфигурационный файл alembic.

Для тестирования используется свой .env файл, для запуска в директории Auth следует 
создать свой .env файл с рабочими настройками. Если этого файла не будет, то конфигурация 
будет иметь значение по умолчанию, как указано в классе *Settings* файла *config.py*

Пароли хранить в открытом виде не безопасно. В production для этого следует использовать секреты.

Для запуска Pytest-ов запускать pytest как выполняемый модуль с ключём -m, чтобы теукущий каталог оказывался в списке рабочих каталогов.
